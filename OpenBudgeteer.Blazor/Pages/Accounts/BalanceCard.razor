@using OpenBudgeteer.Extensions.MetaData.Features.AccountDetails


<MudStack Spacing="4">
    <MudStack Class="d-flex flex-wrap" Row="true" Spacing="1">
        <MudText Class="white-text" Style="font-weight:600" Typo="Typo.h6" HtmlTag="span">@Title</MudText>
        <MudSpacer />
        <MudText Class="white-text" Style="font-weight:500" Typo="Typo.h6" HtmlTag="span">@Balance.DisplayTotal().ToString("C", _customCulture)</MudText>
        <MudText Class="white-text align-self-center pt-1" Style="font-weight:600" Typo="Typo.caption" HtmlTag="span">@Currency.IsoCode</MudText>
    </MudStack>
    <MudProgressLinear Color="Color.Secondary" Size="Size.Large" Rounded="true" Max="@Balance.Max()" Value="@Balance.Value()" />
    <MudStack Class="px-2" Row="true" Justify="Justify.SpaceBetween">
        <MudText Class="white-text" Typo="Typo.subtitle1">What <b>@Balance.TextOne</b></MudText>
        <MudText Class="white-text" Typo="Typo.subtitle1">@Balance.LineOne.ToString("C", _customCulture)</MudText>
    </MudStack>
    <MudStack Class="px-2 mt-n1" Row="true" Justify="Justify.SpaceBetween">
        <MudText Class="white-text" Typo="Typo.subtitle1">What <b>@Balance.TextTwo</b></MudText>
        <MudText Class="white-text" Typo="Typo.subtitle1">@Balance.LineTwo.ToString("C", _customCulture)</MudText>
    </MudStack>
</MudStack>

@code {
    [EditorRequired][Parameter] public required Currency Currency { get; set; }
    [EditorRequired][Parameter] public required BalanceModel Balance { get; set; }
    [EditorRequired][Parameter] public required string Title { get; set; }

    private CultureInfo? _customCulture;

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        _customCulture = new CultureInfo(CultureInfo.CurrentCulture.Name)
            {
                NumberFormat =
            {
                CurrencySymbol = Currency.Symbol,
                CurrencyDecimalDigits = 0
            }
            };
    }
}
